# Tox Configuration for LLMShell

[tox]
min_version = 4.0
env_list = py{310,311,312}, quality, security, docs

[testenv]
description = Run unit tests with coverage
extras = test
commands = pytest tests/ {posargs} --cov=llmshell --cov-report=term-missing --cov-report=xml -m "not integration"

[testenv:integration]
description = Run integration tests (requires Ollama)
extras = test
commands = pytest tests/test_integration.py {posargs} -m integration

[testenv:quality]
description = Run code quality checks
extras = dev
commands = 
    black --check llmshell/ tests/
    isort --check-only llmshell/ tests/
    flake8 llmshell/ tests/
    mypy llmshell/

[testenv:security]
description = Run security checks
extras = build
commands = 
    safety check
    bandit -r llmshell/

[testenv:docs]
description = Build documentation
deps = 
    mkdocs
    mkdocs-material
    mkdocs-mermaid2-plugin
commands = 
    mkdocs build --clean --strict

[testenv:build]
description = Build distribution packages
extras = build
commands = python scripts/build.py --formats wheel sdist

[testenv:clean]
description = Clean build artifacts and cache
deps = 
allowlist_externals = 
    rm
    find
commands = 
    rm -rf build/
    rm -rf dist/
    rm -rf .tox/
    rm -rf .pytest_cache/
    rm -rf .coverage
    rm -rf coverage.xml
    find . -type d -name __pycache__ -exec rm -rf {} +
    find . -type f -name "*.pyc" -delete

[gh-actions]
python = 
    3.10: py310
    3.11: py311, quality, security
    3.12: py312
